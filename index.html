<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¾½çƒæ’é»ç³»çµ± (Badminton Lineup)</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Fonts & Icons -->
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600&family=Noto+Sans+TC:wght@300;400;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <!-- Drag and Drop Touch Polyfill -->
    <script src="https://bernardo-castilho.github.io/DragDropTouch/DragDropTouch.js"></script>

    <link rel="stylesheet" href="lineup.css">
</head>

<body>

    <!-- Top Configuration Bar -->
    <header class="app-header">
        <div class="logo">
            <i class="fas fa-feather-alt gold-icon"></i>
            <h1>Badminton <span class="gold-text">Pro</span> Lineup</h1>
        </div>
        <div class="controls">
            <span id="onlineCount"
                style="font-size: 0.9rem; color: #4ade80; background: rgba(74, 222, 128, 0.1); padding: 4px 12px; border-radius: 20px; border: 1px solid rgba(74, 222, 128, 0.2); white-space: nowrap;">ğŸŸ¢
                1 äººåœ¨ç·š</span>
            <button id="addCourtBtn" class="btn btn-silver"><i class="fas fa-plus"></i> æ–°å¢å ´åœ°</button>
            <div class="toggle-group">
                <span class="label">è‡ªå‹•è¼ªè½‰</span>
                <label class="switch">
                    <input type="checkbox" id="autoModeToggle">
                    <span class="slider round"></span>
                </label>
            </div>
            <div class="toggle-group">
                <span class="label">è¨ˆåˆ†æ¿</span>
                <label class="switch">
                    <input type="checkbox" id="scoreModeToggle" checked>
                    <span class="slider round"></span>
                </label>
            </div>
            <button id="resetBtn" class="btn btn-danger"><i class="fas fa-trash-alt"></i> é‡ç½®</button>
        </div>
    </header>

    <div class="main-container">

        <!-- Left Panel: Waiting Queue -->
        <aside class="panel queue-panel">
            <div class="panel-header">
                <h2><i class="fas fa-hourglass-half"></i> ç­‰å¾…åˆ— (Queue)</h2>
                <div class="queue-stats">
                    <span id="queueCount">0</span> çµ„ç­‰å¾…ä¸­
                </div>
            </div>
            <div id="queueContainer" class="queue-list drop-zone" data-type="queue">
                <!-- Queue Groups will be dynamic -->
                <div class="empty-state">æš«ç„¡ç­‰å¾…çµ„åˆ¥</div>
            </div>
        </aside>

        <!-- Center Panel: Courts -->
        <main class="panel court-panel">
            <div id="courtsContainer" class="courts-grid">
                <!-- Courts will be injected here via JS -->
            </div>
        </main>

        <!-- Right Panel: Player Pool -->
        <aside class="panel players-panel">
            <div class="panel-header">
                <h2><i class="fas fa-users"></i> çƒå“¡åå–®</h2>
                <button id="addPlayerBtn" class="icon-btn"><i class="fas fa-user-plus"></i></button>
            </div>

            <div class="filter-bar">
                <input type="text" id="searchPlayer" placeholder="æœå°‹å§“å...">
            </div>

            <div id="playerPool" class="player-grid drop-zone" data-type="pool">
                <!-- Players injected here -->
            </div>
        </aside>

    </div>

    <!-- Selection Box (Marquee) -->
    <div id="selectionBox" class="selection-box hidden"></div>

    <!-- Drag Proxy (Ghost) -->
    <div id="dragProxy" class="drag-proxy hidden"></div>

    <!-- Add Player Modal -->
    <div id="modalOverlay" class="modal-overlay hidden">
        <div class="modal gold-border">
            <h3>æ–°å¢çƒå“¡</h3>
            <div class="input-group">
                <label>å§“å</label>
                <input type="text" id="newPlayerName" placeholder="è¼¸å…¥å§“å">
            </div>
            <div class="input-group">
                <label>æ€§åˆ¥</label>
                <select id="newPlayerGender">
                    <option value="male">ç”·</option>
                    <option value="female">å¥³</option>
                </select>
            </div>
            <div class="input-group">
                <label>ç¨‹åº¦ (1-10)</label>
                <input type="number" id="newPlayerLevel" min="1" max="10" value="5">
            </div>
            <div class="modal-actions">
                <button id="cancelModalBtn" class="btn btn-silver">å–æ¶ˆ</button>
                <button id="confirmAddPlayerBtn" class="btn btn-gold">æ–°å¢</button>
            </div>
        </div>
    </div>

    <!-- Edit Player Modal -->
    <div id="editModalOverlay" class="modal-overlay hidden">
        <div class="modal gold-border">
            <h3 style="display:flex; justify-content:space-between; align-items:center;">
                ç·¨è¼¯çƒå“¡
                <button id="deletePlayerBtn" class="btn btn-danger btn-sm"
                    style="font-size:0.8rem; padding:4px 8px;">åˆªé™¤</button>
            </h3>
            <input type="hidden" id="editPlayerId">
            <div class="input-group">
                <label>å§“å</label>
                <input type="text" id="editPlayerName" placeholder="è¼¸å…¥å§“å">
            </div>
            <div class="input-group">
                <label>æ€§åˆ¥</label>
                <select id="editPlayerGender">
                    <option value="male">ç”·</option>
                    <option value="female">å¥³</option>
                </select>
            </div>
            <div class="input-group">
                <label>ç¨‹åº¦ (1-10)</label>
                <input type="number" id="editPlayerLevel" min="1" max="10">
            </div>
            <div class="modal-actions">
                <button id="cancelEditModalBtn" class="btn btn-silver">å–æ¶ˆ</button>
                <button id="confirmEditPlayerBtn" class="btn btn-gold">å„²å­˜</button>
            </div>
        </div>
    </div>

    <!-- Confirm Modal -->
    <div id="confirmModalOverlay" class="modal-overlay hidden">
        <div class="modal gold-border" style="width: 400px;">
            <h3 id="confirmTitle" style="margin-top:0;">ç¢ºèª</h3>
            <p id="confirmMessage" style="color:#ddd; margin-bottom:20px;">å…§å®¹</p>
            <div class="modal-actions">
                <button id="cancelConfirmBtn" class="btn btn-silver">å–æ¶ˆ</button>
                <button id="doConfirmBtn" class="btn btn-gold">ç¢ºå®š</button>
            </div>
        </div>
    </div>

    <!-- Floating Action Button for Mobile/Quick Add -->
    <div id="quickAddBtn" class="fab-btn hidden">
        <i class="fas fa-plus"></i> åŠ å…¥åˆ—éšŠ
    </div>

    <!-- System Lock Overlay -->
    <div id="systemLockOverlay" class="modal-overlay hidden" style="background: rgba(0,0,0,0.4); z-index: 9999;">
        <div class="modal gold-border"
            style="width: auto; padding: 20px 40px; display:flex; align-items:center; gap:15px;">
            <div
                style="width: 20px; height: 20px; border: 3px solid var(--gold-start); border-top: 3px solid transparent; border-radius: 50%; animation: spin 1s linear infinite;">
            </div>
            <h3 style="margin:0; color:white; font-size:1.1rem;">å…¶ä»–ä½¿ç”¨è€…æ­£åœ¨æ“ä½œä¸­...</h3>
        </div>
    </div>

    <style>
        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>

    <script src="lineup.js"></script>
</body>

</html>